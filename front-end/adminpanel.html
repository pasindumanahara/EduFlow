<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Dashboard - Student Management</title>
  <link rel="stylesheet" href="adminpanel.css">
</head>
<body class="dark">

  <button class="mobile-toggle" onclick="toggleSidebar()">☰</button>

  <div class="sidebar" id="sidebar">
    <div class="logo">
      <img src="logo.png">
    </div>

    <div class="menu-section">
      <div class="menu-title" onclick="toggleMenu(this)">Student Management</div>
      <div class="menu-content">
        <a href="studentForm.html" target="_blank">Student Registration Form</a>
        <a href="#">Test Link 2</a>
        <a href="#">Test Link 3</a>
      </div>
    </div>

    <div class="menu-section">
      <div class="menu-title" onclick="toggleMenu(this)">Lecturer Management</div>
      <div class="menu-content">
        <a href="lecturerForm.html" target = "_blank">Lecturer Registration Form</a>
        <a href="#">Test Link B</a>
      </div>
    </div>

    <div class="menu-section">
      <div class="menu-title" onclick="toggleMenu(this)">Main Menu 3</div>
      <div class="menu-content">
        <a href="#">Demo X</a>
        <a href="#">Demo Y</a>
      </div>
    </div>

    <div class="static-links">
      <a href="#">Static Link 1</a>
      <a href="#">Static Link 2</a>
      <a href="#">Static Link 3</a>
    </div>

    <div class="sidebar-footer">
      <a href="#">Logout</a>    
      <a href="#">Settings</a>
      <br>
    </div>
  </div>

  <div class="main-content">
    <!---->
    <div class="toggle-wrapper">
      <label class="switch">
        <input type="checkbox" id="fancyToggle">
        <span class="slider"></span>
      </label>
    </div>
    <!---->
    <div class="top-bar">
      <h1>Dashboard</h1>
      <div class="admin">Logged in as <strong>Admin</strong></div>
    </div>
  
    <div class="cards">
      <div class="card">
        <div class="innerCard">
          <img src="logo.png" alt="">
          <div>
            <h3>Students</h3>
            <p id="totalStudents">ERROR</p>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="innerCard">
          <img src="logo.png" alt="">
          <div>
            <h3>Lecturers</h3>
            <p id="totslLecturers">ERROR</p>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="innerCard">
          <img src="logo.png" alt="">
          <div>
            <h3>Active Users</h3>
            <p style="display: inline; color: green;">●</p>
            <p id="totalActiveUsers" style="display: inline;">ERROR</p>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="innerCard">
          <img src="logo.png" alt="">
          <div>
            <h3>Error</h3>
            <p>$12,500</p>
          </div>
        </div>
      </div>
    </div> 
    <!--chart-->
    <div class="cards">
      <div class="card">
        <div class="charts">      
          <canvas id="donutChart" width="300" height="300"></canvas>
          <div class="legend">
            <div class="legend-item">
              <div class="legend-color" style="background-color: #36A2EB;"></div>
              <div class="legend-label"><h3>Boys</h3></div>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #FF6384;"></div>
              <div class="legend-label"><h3>Girls</h3></div>
            </div>
          </div>
        </div>  
      </div> 
    </div>     
  </div>

  <script>
    function toggleMenu(element) {
      const content = element.nextElementSibling;
      content.style.display = content.style.display === "block" ? "none" : "block";
    }

    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      const toggleButton = document.querySelector('.mobile-toggle');
      const content = document.querySelector('.main-content');

      sidebar.classList.toggle('show');

      const isSmallScreen = window.innerWidth <= 768;
      
      if (isSmallScreen) {
        const sidebarOpen = sidebar.classList.contains('show');

        if (sidebarOpen) {
          toggleButton.style.left = '260px';
          content.style.opacity = '0.3';
          toggleButton.textContent = '×';
        } else {
          toggleButton.style.left = '15px';
          content.style.opacity = '1';
          toggleButton.textContent = '☰';
          handleResize(); // CALLING
        }
      } 
    // ERROR OCCURED IN REZISING ADDED THESE LISTNER TO FIX WINDOW RESIZING ERRORS
    function handleResize() {
    if (window.innerWidth >= 1024) {        
        content.style.opacity = '1';         // Reset content opacity
        }
    }
    handleResize();
    window.addEventListener('resize', handleResize);      
    }
    // dark light mode
    const toggle = document.getElementById("fancyToggle");

    // Set theme on page load
    const savedTheme = localStorage.getItem("theme") || "dark";
    document.body.classList.add(savedTheme);
    document.body.classList.remove(savedTheme === "dark" ? "light" : "dark");
    toggle.checked = savedTheme === "dark";

    // Toggle and save preference
    toggle.addEventListener("change", (e) => {
      const isDark = e.target.checked;
      document.body.classList.toggle("dark", isDark);
      document.body.classList.toggle("light", !isDark);
      localStorage.setItem("theme", isDark ? "dark" : "light");
    });
    // chart
    // Get the canvas element and context
    const canvas = document.getElementById('donutChart');
      const ctx = canvas.getContext('2d');

      // Function to draw a donut chart
      function drawDonutChart(ctx, data, colors, x, y, radius, cutout) {
        const total = data.reduce((sum, value) => sum + value, 0);
        let startAngle = -0.5 * Math.PI; // Start from top (12 o'clock)

        // Draw each segment
        data.forEach((value, index) => {
          const sliceAngle = (value / total) * 2 * Math.PI;
          ctx.beginPath();
          ctx.arc(x, y, radius, startAngle, startAngle + sliceAngle); // Outer arc
          ctx.arc(x, y, radius - cutout, startAngle + sliceAngle, startAngle, true); // Inner arc (cutout)
          ctx.closePath();
          ctx.fillStyle = colors[index];
          ctx.fill();
          startAngle += sliceAngle;
        });
      }

      // Donut chart data and colors
      const boysCount = 65;
      const girlsCount = 35;
      
      const data = [boysCount, girlsCount]; // Values for the two segments
      const colors = ['#36A2EB', '#FF6384']; // Colors for the segments

      // Draw the chart
      drawDonutChart(ctx, data, colors, 150, 150, 120, 40); // x, y, outer radius, inner cutout

  </script>
</body>
</html>
